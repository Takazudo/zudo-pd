import CircuitSvg from '@site/src/components/CircuitSvg';
import LdoU7Svg from '@site/static/circuits/ldo-u7-diagram.svg';

<CircuitSvg
  src={LdoU7Svg}
  alt="LM7805 Linear Regulator U7"
  padding="10px"
/>

**Capacitor Placement (Critical for PCB layout):**
- **C15/C18 (ceramic)**: Place RIGHT NEXT to IC pins (minimize trace length for high-freq filtering)
- **C22/C23 (electrolytic)**: Can be placed farther from IC (bulk storage, less sensitive to distance)

**Key Points:**
- **Two-stage design**: Buck converter (U3) provides efficient voltage reduction, linear regulator (U7) provides low-noise final output
- **Input capacitor order**: C22 (bulk, farther) and C15 (ceramic, close to IC)
- **Output capacitor order**: C18 (ceramic, close to IC) and C23 (bulk, farther)
- **LED indicator**: Blue LED (LED3) with 1kΩ current-limiting resistor shows +5V rail is active
- **LED current**: I = (5V - 2V) / 1kΩ = 3mA (dimmer than +12V LED, consider 330Ω for brighter)
- **Dropout voltage**: LM7805 requires ~2V dropout, so 7.5V input provides 2.5V headroom

<details>
<summary>View ASCII art circuit</summary>

```
Regulator IC:
                    ┌──────────────────┐
+7.5V IN ───────────┤1 IN         OUT 3├──────────── +5V OUT
                    │                  │
                 ┌──┤2 GND             │
                 │  └──────────────────┘
                GND      LM7805
                        (TO-263-2)

Input Capacitors (C15 closest to IC):
+7.5V ───┬────────────────┬─── To IC Pin 1
         │                │
        C22              C15
       470µF            470nF
    electrolytic       ceramic
     (farther)        (CLOSE!)
         │                │
        GND              GND

Output Capacitors (C18 closest to IC):
From IC Pin 3 ──┬────────────────┬─── +5V
                │                │
               C18              C23
              100nF            470µF
             ceramic        electrolytic
             (CLOSE!)        (farther)
                │                │
               GND              GND

Status LED:
+5V ──── R8 (1kΩ) ──── LED3 (Blue) ──── GND
```

</details>

---

### Protection Circuit (+5V Rail)

```
+5V Rail Protection (0.5A target, 1A max):

+5V IN ─── PTC2 ───┬─→ +5V OUT
      mSMD110-33V  │
      (1.1A hold)  │
      (2.2A trip)  │
                   │
                  ┌┴┐ TVS2 (PRTR5V0U2X)
                  │ │ Bidirectional
                  └┬┘
                   │
                  GND

Status Indicator:
+5V OUT ─── R8 ─── LED3 ─── GND
          (1kΩ)  (Blue)
```

**Protection Layers:**

- Layer 1: LM7805 current limiting (~1A max, immediate) ✅
- Layer 2: LM7805 thermal shutdown (150°C, 1-5s) ✅
- Layer 3: PTC2 trips (>2.2A, 1-5s) → Auto-reset after 30-60s ✅
- Layer 4: USB-PD adapter protection (backup) ✅

**Components:**
- **PTC2**: C70119 (mSMD110-33V) - 1.1A hold, 2.2A trip, 1812
- **TVS2**: PRTR5V0U2X (bidirectional, 5V) - ESD and overvoltage protection
- **LED3**: Blue LED with R8 (1kΩ) - Status indicator

**Protection Operation:**
- **Normal** (&lt;1.1A): PTC low resistance, LED illuminated
- **Overload** (1.1A-2.2A): PTC heats up, trips in 1-5s, LED dims/off
- **Short circuit** (&gt;2.2A): LM7805 current limiting activates immediately, PTC trips in 1-5s
- **Auto-reset**: PTC resets after 30-60s cooling period
